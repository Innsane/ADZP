@page
@model AlgorytmDobieraniaZasobowProdukcyjnych.Pages.TreeViewModel
@{
    ViewData["Title"] = "TreeView";
}
@using AlgorytmDobieraniaZasobowProdukcyjnych.Models;
@section Scripts
{
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

    <script type="text/javascript">
$(document).ready(function () {
    $('#treeView').jstree({
        plugins: [ "changed" ],
        core: {
            "data": @Html.Raw(ViewData["json"]),
        }
    });
});
        $(document).ready(function () {
            $('#dataTable').DataTable({
                processing: true,
            })
        });

        
        $("#treeView").on("changed.jstree", function (e, data) {
            var oldName = "";
        $("#lb").text(data.node.id);
        $("#tableName").val(data.node.data[0]);

        
        

        console.log("ID: " + data.node.id);
        $('#dataTable').DataTable().column('#kod').search(data.node.id).draw();
        $.ajax({
            type: "GET",
            contentType: "text/plain",
        })
    });

    </script>
}
<label>Symbol wybranego zasobu: </label>
<label id="lb"> </label>


<form id="form" method="post">
    <select name="picked" asp-for="Picked">
        @foreach (var resource in Model.Resources)
        {
            <option id="item" value="@resource.KeyId">@resource.Nazwa</option>
        }
    </select>
    <br />  
    <label>Nazwa wybranej tablicy: </label>
    <input asp-for="TableName" type="text" id="tableName" name="tableName" value="" disabled />
    <input type="submit" id="submitName" value="Display" />
</form>


<div class="row">
    <div style="font-size: 12px"
         id="treeView" class="col-3">

    </div>

    <div class="col-9">
        <table style="font-size:0.9rem"; text-align="justify",
               id="dataTable" class="table table-sm table-bordered table-hover table-responsive"
               width="100%" cellspacing="0">
            <thead class="thead-light">
                <tr>
                    @foreach (var info in Model.Infos)
                    {
                        if (info.Name == "Kod")
                        {
                            <th id="kod" scope="col">@info.Name</th>
                        }
                        else
                        {
                            <th scope="col">@info.Name</th>
                        }
                    }
                </tr>
            </thead>
            <tbody>
                @foreach (var data in Model.Datas)
                {
                    <tr>
                        @foreach (var info in Model.Infos)
                        {
                            <td>@info.GetValue(data)</td>
                        }
                    </tr>
                }
            </tbody>

        </table>
    </div>
</div>













